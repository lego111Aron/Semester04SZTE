
<!doctype html>
<html lang="hu" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../04_gyakorlat/index.html">
      
      
        <link rel="next" href="../06_webapi/index.html">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.9">
    
    
      
        <title>5. gyakorlat (DAO) - Alkalmazásfejlesztés I. gyakorlat</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0d440cfe.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="Indigo" data-md-color-accent="Indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#5-gyakorlat" class="md-skip">
          Kihagyás
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Élőfej">
    <a href="../index.html" title="Alkalmazásfejlesztés I. gyakorlat" class="md-header__button md-logo" aria-label="Alkalmazásfejlesztés I. gyakorlat" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Alkalmazásfejlesztés I. gyakorlat
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5. gyakorlat (DAO)
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Keresés" placeholder="Keresés" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Keresés">
        
        <button type="reset" class="md-search__icon md-icon" title="Törlés" aria-label="Törlés" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Keresés inicializálása
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigáció" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Alkalmazásfejlesztés I. gyakorlat" class="md-nav__button md-logo" aria-label="Alkalmazásfejlesztés I. gyakorlat" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82Z"/></svg>

    </a>
    Alkalmazásfejlesztés I. gyakorlat
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Általános
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Általános
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Kezdőlap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../00_Kovetelmenyek/index.html" class="md-nav__link">
        Követelmények
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Jegyzet
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Jegyzet
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../01_gyakorlat/index.html" class="md-nav__link">
        1. gyakorlat (XML + Maven)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02_gyakorlat/index.html" class="md-nav__link">
        2. gyakorlat (Alap JavaFX elemek)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../03_gyakorlat/index.html" class="md-nav__link">
        3. gyakorlat (Táblázat kezelés)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04_gyakorlat/index.html" class="md-nav__link">
        4. gyakorlat (FXML)
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          5. gyakorlat (DAO)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./index.html" class="md-nav__link md-nav__link--active">
        5. gyakorlat (DAO)
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mvc-bevezetes" class="md-nav__link">
    MVC bevezetés
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-reteg" class="md-nav__link">
    Model réteg
  </a>
  
    <nav class="md-nav" aria-label="Model réteg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bean-osztalyok" class="md-nav__link">
    Bean osztályok
  </a>
  
    <nav class="md-nav" aria-label="Bean osztályok">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-access-object-dao" class="md-nav__link">
    Data Access Object (DAO)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#view-reteg" class="md-nav__link">
    View réteg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#videok" class="md-nav__link">
    Videók
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenciak" class="md-nav__link">
    Referenciák
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06_webapi/index.html" class="md-nav__link">
        6. gyakorlat (Web API)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06_kivonat/index.html" class="md-nav__link">
        Web API kivonat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../misc/generics/index.html" class="md-nav__link">
        Extra - Java Generikusok
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../misc/lambda/index.html" class="md-nav__link">
        Extra - Lambda kifejezések
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../misc/troubleshoot/index.html" class="md-nav__link">
        Troubleshoot
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Régi anyag
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Régi anyag
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/01_gyakorlat/index.html" class="md-nav__link">
        1. gyakorlat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/02_gyakorlat/index.html" class="md-nav__link">
        2. gyakorlat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/03_gyakorlat/index.html" class="md-nav__link">
        3. gyakorlat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/04_gyakorlat/index.html" class="md-nav__link">
        4. gyakorlat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/05_gyakorlat/index.html" class="md-nav__link">
        5. gyakorlat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/06_gyakorlat/index.html" class="md-nav__link">
        6. gyakorlat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/07_gyakorlat/index.html" class="md-nav__link">
        7. gyakorlat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/08_gyakorlat/index.html" class="md-nav__link">
        8. gyakorlat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/09_gyakorlat/index.html" class="md-nav__link">
        9. gyakorlat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/10_gyakorlat/index.html" class="md-nav__link">
        10. gyakorlat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/11_gyakorlat/index.html" class="md-nav__link">
        11. gyakorlat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/12_gyakorlat/index.html" class="md-nav__link">
        12. gyakorlat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/13_gyakorlat/index.html" class="md-nav__link">
        13. gyakorlat
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mvc-bevezetes" class="md-nav__link">
    MVC bevezetés
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-reteg" class="md-nav__link">
    Model réteg
  </a>
  
    <nav class="md-nav" aria-label="Model réteg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bean-osztalyok" class="md-nav__link">
    Bean osztályok
  </a>
  
    <nav class="md-nav" aria-label="Bean osztályok">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-access-object-dao" class="md-nav__link">
    Data Access Object (DAO)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#view-reteg" class="md-nav__link">
    View réteg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#videok" class="md-nav__link">
    Videók
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenciak" class="md-nav__link">
    Referenciák
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="5-gyakorlat">5. gyakorlat<a class="headerlink" href="#5-gyakorlat" title="Permanent link">&para;</a></h1>
<h2 id="mvc-bevezetes">MVC bevezetés<a class="headerlink" href="#mvc-bevezetes" title="Permanent link">&para;</a></h2>
<p>Az MVC architekturális model az egyik legegyszerűbb mind közül.
3 jól elkülöníthető réteget definiál melyek:</p>
<ul>
<li>Model (M)</li>
<li>View (V)</li>
<li>Controller (C)</li>
</ul>
<p>A rétegek közül a felhasználó a View-n keresztül kommunikál. A felhasználói interakció valamilyen eseményeket generál, melyre a Controller a megfelelő hívásokat ejtheti meg. A Controller tekinthető egy középső rétegnek, mert a Model réteget csak ő képes adatmódosítási céllal elérni. Tehát a View-ból például sosem kezdeményezünk adatbázis műveleteket, mert az veszélyes lenne az alkalmazás szempontjából, illetve a View-nak nem is kell tudnia arról, hogy az adat honnan jön és hogyan van tárolva. Számára az a lényeg, hogy tudja hogy milyen adatokat kell megjelenítenie a felhasználó számára.</p>
<p>A Controller-ben végzünk minden üzleti logikával kapcsolatos tevékenységet. Például bizonyos mezők értéke alapján egyéb értékeket állíthatunk be automatikusan, melyet már a felhasználó nem lát.</p>
<p>A Model réteg több dolgot foglalhat magában. Egyrészt a Bean osztályainkat rendre itt szoktuk létrehozni (A Bean definícióját lásd később). Másrészt az úgynevezett DAO is itt szokott helyet foglalni, mely az adatelérésért felelős, legyen az egy adatbázisban vagy egy fájlban.</p>
<p>Ezen felül a View rétegnek nyilván szüksége lehet magukra a Bean-ekre is, ezért ő használhat ilyen jellegű olvasási műveleteket közvetlenül a Model rétegből.</p>
<p>Az imént leírtak grafikusan szemléltetve:</p>
<p><img alt="mvc" src="../img/03/mvc.png" /></p>
<h2 id="model-reteg">Model réteg<a class="headerlink" href="#model-reteg" title="Permanent link">&para;</a></h2>
<h3 id="bean-osztalyok">Bean osztályok<a class="headerlink" href="#bean-osztalyok" title="Permanent link">&para;</a></h3>
<p>3 tulajdonsággal kell rendelkeznie egy <code>Bean</code> osztálynak:</p>
<ul>
<li>Van publikus default konstruktora</li>
<li>Minden adattaghoz tartozik publikus getter/setter (másnéven accessorok)</li>
<li>Az osztálynak <strong>szerializálhatónak</strong> kell lennie</li>
</ul>
<p>Az első kettőt talán nem kell elmagyarázni, de mi is az a szerializálhatóság?
A Java rendelkezik az úgynevezett objektum szerializálással, ami szerint egy objektum reprezentálható egy bájt stream-mel, mely tartalmazza az objektum típusát, illetve hogy maga az objektum milyen típusú fieldekkel rendelkezik, továbbá a konkrét adatot is ezekhez a fieldekhez.
Másszóval a bájtstreamben benne van az objektum aktuális állapota (melyik field milyen értéket tárol).
Amennyiben ezt a bájtfolyamot valahova elmentjük ezt nevezzük szerializációnak.
Ez megfelel az objektum aktuális állapotának elmentésével.
Például lementhetjük egy objektum állapotát ilyen módon egy fájlba is, de például az is szerializáció, amikor egy objektumot JSON formára alakítunk (közkedvelt keretrendszer a Jackson ennek használatára).
Amikor az elmentett állapotot visszatöltjük (a memóriába), akkor <strong>deszerializációról</strong> beszélünk.
Ahhoz, hogy egy osztály objektumai szerializálhatóak legyenek egyszerűen meg kell valósítanunk a <code>Serializable</code> interface-t.
Esetünkben egyelőre nem fogjuk alkalmazni az interfészt.
Amint szükségünk lesz rá, akkor azt úgyis könnyen megtehetjük.</p>
<h4 id="data-access-object-dao">Data Access Object (DAO)<a class="headerlink" href="#data-access-object-dao" title="Permanent link">&para;</a></h4>
<p>Miután elkészültek a bean-ek, elkezdhetünk dolgozni a DAO-n.
A <strong>DAO (Data Access Object)</strong> az adatelérési réteget adja meg, mely a model rétegen belülre sorolható.
A konkrét hozzáadás és listázás itt történik (mármint az adatok tárolása, legyen az memória, adatbázis, fájl vagy bármi egyéb).
A controller rétegünk majd ezt fogja felhasználni.
Fontos, hogy itt tartsuk mindig szem előtt, hogy interface mögé rejtsük az aktuális implementációt, mely biztosítja, hogy könnyen cserélhető legyen a megvalósítás.</p>
<p>Először készítsük el a jól definiált interface-t!
Ehhez készítsünk egy új interface-t <code>UtazasDAO</code> néven a <code>hu.alkfejl.dao</code> csomagba!</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">UtazasDAO</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">Utazas</span><span class="w"> </span><span class="n">utazas</span><span class="p">);</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Utazas</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="n">Utazas</span><span class="w"> </span><span class="n">utazas</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Első körben 2 implementálandó metódussal rendelkezik, melyek már felhasználják ez előzőleg definiált bean osztályunkat.
A 3 megadott metódus lenyomat az összes kontakt listázásához, egy kontakt mentéséhez/módosításához és a törléshez lesz majd használható.
A hozzáadásnál fontos, hogy visszaadunk egy <code>Utazas</code> értéket is, melynek szerepe, hogy a controller felé jelezze, hogy sikeresen megtörtént a beszúrás vagy valami hiba végett ez meghiúsult (ebben az esetben adhat vissza <code>null</code>-t is akár).
Nyilván nem túl szofisztikált azt közölni a felhasználóval, hogy 'Valami hiba történt', mivel a felhasználó általában arra is kíváncsi, hogy mi volt a hiba oka.
Erre most nem térünk ki, de bővítési lehetőségként mindenki elkészítheti saját maga számára.</p>
<p>Miután megvan az interface, el kell készítenünk egy tényleges implementációt is hozzá.
Ehhez készítsünk egy osztályt az interface mellé <code>ContactDAOImpl</code> néven.
A megvalósításunk jelen esetben egy SQLite adatbázist fog használni, ugyanakkor a konkrét adatbázis nem jelenik meg a kódban, hiszen a <a href="https://en.wikipedia.org/wiki/Java_Database_Connectivity">JDBC - Java Database Connectivity</a> API-t használjuk.
A JDBC egységes interfészt ad a különböző adatbázisok kezeléséhez, melyeket akár kombinálhatjuk is egy alkalmazáson belül.
A konkrét megvalósításokat, melyeket az adatbázis gyártók (vendorok) szolgáltatják, a JDBC <code>DriverManager</code> osztályán keresztül regisztrálhatjuk.
A <code>DriverManager</code> továbbá egy <code>Connection</code> factoryként is funkcionál, azaz tőle tudunk adatbázis kapcsolati objektumokat kérni a <code>getConnection()</code> factory metóduson keresztül.
A JDBC segítségével mind DDL (Data Definition Language) és DML (Data Manipulation Language) parancsokat is kiadhatunk, továbbá tárolt eljárásokat is meghívhatunk.
Az SQL utasításokhoz a JDBC a következő osztályokat biztosítja:</p>
<ul>
<li><strong>Statement</strong>: Egyszerű paraméter nélküli utasításokhoz. Például <code>SELECT * FROM CONTACT</code>.</li>
<li><strong>PreparedStatement</strong>: Paraméteres lekérdezésekhez. Például: <code>SELECT * FROM CONTACT WHERE id = ?</code>, ahol az <code>id</code> értékét a valamilyen tetszőleges értékre állíthatjuk majd be.</li>
<li><strong>CallableStatement</strong>: Tárolt eljárások használatához/meghívásához. Például: <code>{call proc_name(?,?)}</code>.</li>
</ul>
<p>Ezek közül a későbbiekben az első kettőt fogjuk használni.
A JDBC továbbá támogatja a tranzakciókezelést is, de ezzel a kurzuson nem foglalkozunk.</p>
<p>Magához a JDBC használatához nem kell semmilyen függőséget sem megadnunk, hiszen a JDBC részét képezi a Java SE-nek, azaz benne van az JDK-ban.
Viszont az adott adatbázis driver-ét biztosítani kell futásközben, így adjuk hozzá az SQLite drivert a <code>pom.xml</code> függőségeihez!</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">&lt;dependency&gt;</span>
<span class="w">    </span><span class="nt">&lt;groupId&gt;</span>org.xerial<span class="nt">&lt;/groupId&gt;</span>
<span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>sqlite-jdbc<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">    </span><span class="nt">&lt;version&gt;</span>3.34.0<span class="nt">&lt;/version&gt;</span>
<span class="w">    </span><span class="nt">&lt;scope&gt;</span>runtime<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></td></tr></table></div>
<p>Miután ezzel megvagyunk, az IntelliJ-n belül a jobb felső sarokban a <code>Database</code> fülre navigálva tudjuk létrehozni az adatbázisunkat (csak az Ultimate verzióban, amihez érdemes megigényelni a student license-t a Jetbreains-től).</p>
<p><center>
<img alt="intellij database" src="../img/05/intellij_database_tab.png" />
</center></p>
<p>Ezután a Database fülön a bal felső sarokban szereplő <kbd>+</kbd> jelre kattintva egy új adatbázist adathatunk hozzá.
Ehhez válasszuk a lenyíló menüben a <code>Data Source -&gt; SQLite</code> menüpontot!
A Data Source-nak adhatunk egy tetszőleges nevet, majd a General beállításoknál a fájl alatt megadhatjuk, hogy melyik létező adatbázisfájlból dolgozunk.
Amennyiben új állományt szeretnénk használni, akkor File megadása sor végén válasszuk a <kbd>+</kbd> jelet és adjuk meg az adatbázis fájl helyét.
Az URL-t a JDBC-n belül is használni fogjuk majd, mivel ezzel az URL-el tudunk kapcsolatot létesíteni az adatbázis felé.
Amennyiben az IntelliJ-n belül nincs még letöltve az SQLite Driver, akkor <code>Properties</code> lapon beállíthatjuk (utólag jobb klikk az adatbázis kapcsolatra és <code>Properties</code> menüpont kiválasztása).
Ezután megjelenik a megfelelő nevű adatbázis a listában, amelyet lenyitva megtekinthetjük az adatbázishoz tartozó sémákat.
Itt a <code>main</code>-re jobb klikk után <code>New -&gt; Table</code> menüpontot választva létrehozhatjuk a kívánt táblákat (később egy táblára jobb klikk, majd <code>Modify Table</code> opcióval módosíthatjuk annak összetételét).</p>
<p><center>
<img alt="intellij database - modify table" src="../img/05/intellij_database_modify_table.png" />
</center></p>
<p>Miután létrehoztuk a megfelelő táblákat jobb klikk a <code>main</code> sémára, majd <code>SQL Scripts -&gt; Generate DDL to Query Console</code>.
Itt láthatjuk a legenerált DDL utasításokat, mely így néz ki:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">utazas</span>
<span class="p">(</span>
<span class="w">    </span><span class="n">ID</span><span class="w">           </span><span class="nb">integer</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span>
<span class="w">        </span><span class="k">constraint</span><span class="w"> </span><span class="n">utazas_pk</span>
<span class="w">            </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="n">autoincrement</span><span class="p">,</span>
<span class="w">    </span><span class="n">Nev</span><span class="w">          </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">Uticel</span><span class="w">       </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="n">Felpanzio</span><span class="w">    </span><span class="nb">integer</span><span class="p">,</span>
<span class="w">    </span><span class="n">Vendeg_szam</span><span class="w">  </span><span class="nb">integer</span><span class="p">,</span>
<span class="w">    </span><span class="n">Ejszaka_szam</span><span class="w"> </span><span class="nb">integer</span>
<span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>Mivel az adatbázis elérését többször is használni kívánjuk majd, így célszerű ezt az értéket kiszerveznünk egy állományba.
Hozzunk létre a <code>/resources</code> alá egy <code>application.properties</code> állományt majd adjuk meg benne az adatbázis URL-jét (shift + enter, ha nincs meg):</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="na">db.url</span><span class="o">=</span><span class="s">jdbc:sqlite:E:/Oktatas/AF1/23242/gyak04/utazas.db</span>
</code></pre></div></td></tr></table></div>
<p>Az URL-t mindenki módosítsa a saját környezetének megfelelően!
Ezután készítsünk egy segédosztályt, mely beolvassa ezt a <code>properties</code> állományt, melyben a kulcs-érték párokat adjuk meg (itt bármilyen tetszőleges párokat felvehetünk, amit majd később használni szeretnénk).
Erre a célra készítsünk a <code>hu.alkfejl.dao</code> csomag alá egy <code>ConfigManager</code> nevű osztályt, melynek a tartalma a következő:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConfigManager</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Properties</span><span class="w"> </span><span class="n">props</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Properties</span><span class="p">();</span>

<span class="w">    </span><span class="kd">static</span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">props</span><span class="p">.</span><span class="na">load</span><span class="p">(</span><span class="n">ConfigManager</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getResourceAsStream</span><span class="p">(</span><span class="s">&quot;/application.properties&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getValue</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">key</span><span class="p">){</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Mivel egy statikus metódusokat kínáló osztályról lesz szó, így a <a href="https://www.geeksforgeeks.org/g-fact-79/index.html">statikus init blokkban</a> adjuk meg a properties fájl betöltését.
Ezután a property-ket eltároljuk egy lokális változóban, melyeket a <code>getValue</code> segítségével érhetünk el.</p>
<p>Ezután végre elkészíthetjük a DAO megvalósítását.
Először nézzük a field-eket és a <code>Singleton</code> tervezési minta alkalmazását!</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UtazasDbDAOImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w">  </span><span class="n">UtazasDAO</span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">CONN</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">UtazasDbDAOImpl</span><span class="w"> </span><span class="n">instance</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w">  </span><span class="nf">UtazasDbDAOImpl</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">conn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">CONN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conn</span><span class="p">;</span>
<span class="w">        </span><span class="k">try</span><span class="p">{</span>
<span class="w">            </span><span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="s">&quot;org.sqlite.JDBC&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="n">e</span><span class="p">){</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">UtazasDbDAOImpl</span><span class="w"> </span><span class="nf">getInstance</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">connStr</span><span class="p">){</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">instance</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">){</span>
<span class="w">            </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="n">UtazasDbDAOImpl</span><span class="p">.</span><span class="na">class</span><span class="p">){</span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">instance</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">){</span>
<span class="w">                    </span><span class="n">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UtazasDbDAOImpl</span><span class="p">(</span><span class="n">connStr</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">instance</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">Query</span><span class="p">{</span>
<span class="w">        </span><span class="n">INSERT</span><span class="p">(</span><span class="s">&quot;INSERT INTO utazas (Nev, Uticel, Felpanzio, Vendeg_szam, Ejszaka_szam) VALUES(?,?,?,?,?);&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="n">SELECT</span><span class="p">(</span><span class="s">&quot;SELECT * FROM utazas;&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="n">FILTER</span><span class="p">(</span><span class="s">&quot;SELECT * FROM utazas WHERE Uticel = ?;&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">command</span><span class="p">;</span>

<span class="w">        </span><span class="n">Query</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">command</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">command</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getCommand</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">command</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Maga az osztály két privát, statikus adattagot tartalmaz. A <code>CONN</code>-ba fogjuk betölteni az adatbázis elérési útvonalát, míg az <code>instance</code> a Singleton mintát követve az egyetlen példány lesz az osztyunkból.
A privát hozzáférésű konstruktorunk egy paramétert (a kapcsolati stringet) várja és ezt adja értékül a <code>CONN</code>-nak. Ezt követően egy védett blokkban betöltjük a szükséges JDBC drivert a <code>Class</code> osztály <code>forName</code> metódusa segítségével.
A <code>getInstance</code> függvény arra szolgál, hogy az első hívás alkalmával létrehozza az egyetlen példányt az osztályból, minden további esetben pedig ezen keresztül lehessen lekérni. A példában látott minta először ellenőrzi, hogy null-e az instance értéke, és ha igen, akkor lép tovább. Itt a többszálú rendszerek miatt alkalmazunk egy <code>syncronized</code> blokkot, aminek paramétere az osztályounk <code>class</code> implicit adattagja. Ezzel elérjük azt, hogy egyszerre csak egy szál férhez hozzá a blokk belsejéhez, mégpedig az, aki ezt a class példányt éppen birtokolja. LEgbelül ismét egy null-checket alkalmazunk, elkerülve ezzel zt, hogy minden szál, aki éppen hívja a getInstance-t felülírja a singleton példányt.</p>
<p>Mindezek után hozzáadjuk az SQL lekérdezéseket is az osztályunkhoz, amihez egy <code>enum</code>-ot fogunk használni. Ezt amiatt tehetjük meg, hogy bár a főleg arra használjuk, hogy felsorolások elemeit definiáljuk általuk, de az enumok is osztályok, így természetesen ugyanúgy tartalmazhatnak adattagokat és tagfüggvényeket, mint bármelyik másik osztály.
Tehát nincs más dolgunk, mint az enum-példányok deifiníciója után felvenni egy privát String adattagot a  lekérdezés tárolására és definiálni a megfelelő konstruktort és gettert, hogy a későbbiekben is hozzá lehessen férni.</p>
<p>A következő kódrészlet a mentés opciót szolgáltatja számunkra.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@Override</span>
<span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">Utazas</span><span class="w"> </span><span class="n">utazas</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="k">try</span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">CONN</span><span class="p">);</span>
<span class="w">            </span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">pst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">Query</span><span class="p">.</span><span class="na">INSERT</span><span class="p">.</span><span class="na">command</span><span class="p">,</span><span class="w"> </span><span class="n">Statement</span><span class="p">.</span><span class="na">RETURN_GENERATED_KEYS</span><span class="p">))</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">pst</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">utazas</span><span class="p">.</span><span class="na">getNev</span><span class="p">());</span>
<span class="w">            </span><span class="n">pst</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">utazas</span><span class="p">.</span><span class="na">getUticel</span><span class="p">());</span>
<span class="w">            </span><span class="n">pst</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">utazas</span><span class="p">.</span><span class="na">getFelpanzio</span><span class="p">()</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">);</span>
<span class="w">            </span><span class="n">pst</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">utazas</span><span class="p">.</span><span class="na">getUtasok</span><span class="p">());</span>
<span class="w">            </span><span class="n">pst</span><span class="p">.</span><span class="na">setInt</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">utazas</span><span class="p">.</span><span class="na">getEjszaka</span><span class="p">());</span>

<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">affectedRows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pst</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">affectedRows</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="w">        </span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">){</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>Az első érdekes dolog, hogy itt egy paraméteres lekérdezésünk lesz, így egy <code>PreparedStatement</code>-et használunk.
Ez arra szolgál, hogy a lekérdezés összeszerkesztésekor a paraméterek helyére kerülő értékeket olyan módon alakítsuk át, hogy azt az adatbázis ne tudja önmagában utasításként értelmezni, így elkerülhetjük az SQL-injection-t.
A következő érdekes momentum, hogy új kontakt létrehozásakor a <code>c.prepareStatement(Query.INSERT.command, Statement.RETURN_GENERATED_KEYS)</code> lekérdezést adjuk meg, melyben vegyük észre a <code>RETURN_GENERATED_KEYS</code> megadást.
Az <code>executeUpdate</code> metódus azt adja vissza, hogy hány sor módosult az SQL utasítás hatására, mely esetünkben 1 kell hogy legyen, ha sikerült, egyéb esetekben 0, máskülönben valamit nagyon rosszul csináltunk.</p>
<p>A listázáshoz tartozó függvény sokban hasonlít a beszúrásra, de az első amit észreveszünk, hogy a try-with-resources-ban immár a <code>Statement stmt = c.createStatement(); ResultSet rs = stmt.executeQuery(Query.SELECT.command)</code> utasítások szerepelnek. Ebből két dolog derülhet ki. Egyfelől, mivel az ehhez a függvényhez használt SQL-lekérdezésben nincsenek behelyettesítendő paraméterek, így nincs szükség arra, hogy átalakítsuk a tartalmát, másfelől itt viszont szeretnénk ténylegesen felhasználni azokat a rekordokat, amiket érint az utasítás végrehajtása, így  a <code>ResultSet</code> ezeket fogja tartalmazni.
Az elemek kinyeréséhez a <code>ResultSet</code> osztály <code>next</code> függvényét használjuk, amely egyrészt egy logikai értékkel jelzi számunkra, hogy van-e még elem a halmazban, másrészt átállítja az aktuális elemet, így az az az alább látható módon kinyerhető (megjegyzendő, hogy a <code>ResultSet</code> getXXX függvényei <code>int</code> paraméteres változatban is léteznek, ahol a kívánt oszlop indexe adható meg). Végül a tábla tartalmából kiválogatjuk a nekünk lényeges elemeket azáltal, hogy a paraméterben kapott objektum értékeire szűrjük a listánkat a <code>Stream api</code> segítségével.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Utazas</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="n">Utazas</span><span class="w"> </span><span class="n">filter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Utazas</span><span class="o">&gt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>

<span class="w">        </span><span class="k">try</span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">CONN</span><span class="p">);</span>
<span class="w">            </span><span class="n">Statement</span><span class="w"> </span><span class="n">stmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="na">createStatement</span><span class="p">();</span>
<span class="w">            </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">(</span><span class="n">Query</span><span class="p">.</span><span class="na">SELECT</span><span class="p">.</span><span class="na">command</span><span class="p">))</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="k">while</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">()){</span>
<span class="w">                </span><span class="n">Utazas</span><span class="w"> </span><span class="n">utazas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Utazas</span><span class="p">();</span>
<span class="w">                </span><span class="n">utazas</span><span class="p">.</span><span class="na">setNev</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;Nev&quot;</span><span class="p">));</span>
<span class="w">                </span><span class="n">utazas</span><span class="p">.</span><span class="na">setUticel</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;Uticel&quot;</span><span class="p">));</span>
<span class="w">                </span><span class="n">utazas</span><span class="p">.</span><span class="na">setFelpanzio</span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;Felpanzio&quot;</span><span class="p">)));</span>
<span class="w">                </span><span class="n">utazas</span><span class="p">.</span><span class="na">setUtasok</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;Vendeg_szam&quot;</span><span class="p">));</span>
<span class="w">                </span><span class="n">utazas</span><span class="p">.</span><span class="na">setEjszaka</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;Ejszaka_szam&quot;</span><span class="p">));</span>

<span class="w">                </span><span class="n">result</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">utazas</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">){</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">utazas</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">filter</span><span class="p">.</span><span class="na">getNev</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">utazas</span><span class="p">.</span><span class="na">getNev</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">filter</span><span class="p">.</span><span class="na">getNev</span><span class="p">()))</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">utazas</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">filter</span><span class="p">.</span><span class="na">getUticel</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">utazas</span><span class="p">.</span><span class="na">getUticel</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">filter</span><span class="p">.</span><span class="na">getUticel</span><span class="p">()))</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">utazas</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">filter</span><span class="p">.</span><span class="na">getUtasok</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">utazas</span><span class="p">.</span><span class="na">getUtasok</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">filter</span><span class="p">.</span><span class="na">getUtasok</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">utazas</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">filter</span><span class="p">.</span><span class="na">getEjszaka</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">utazas</span><span class="p">.</span><span class="na">getEjszaka</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">filter</span><span class="p">.</span><span class="na">getEjszaka</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">utazas</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">filter</span><span class="p">.</span><span class="na">getLeiras</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">utazas</span><span class="p">.</span><span class="na">getLeiras</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">filter</span><span class="p">.</span><span class="na">getLeiras</span><span class="p">()))</span>
<span class="w">                </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
Ugyanez a <code>find</code> művelet megvalósítható a <code>FILTER</code> enum konstanssal is az alábbi módon például az úticél szerint (ez esetben a szűrést már az adatbázis-oldalon elvégezzük):
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Utazas</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">find</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Utazas</span><span class="o">&gt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>

<span class="w">        </span><span class="k">try</span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">CONN</span><span class="p">);</span>
<span class="w">            </span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">pst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="n">Query</span><span class="p">.</span><span class="na">INSERT</span><span class="p">.</span><span class="na">command</span><span class="p">);</span>
<span class="w">            </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">())</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="k">while</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">()){</span>
<span class="w">                </span><span class="n">Utazas</span><span class="w"> </span><span class="n">utazas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Utazas</span><span class="p">();</span>
<span class="w">                </span><span class="n">utazas</span><span class="p">.</span><span class="na">setNev</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;Nev&quot;</span><span class="p">));</span>
<span class="w">                </span><span class="n">utazas</span><span class="p">.</span><span class="na">setUticel</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;Uticel&quot;</span><span class="p">));</span>
<span class="w">                </span><span class="n">utazas</span><span class="p">.</span><span class="na">setFelpanzio</span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;Felpanzio&quot;</span><span class="p">)));</span>
<span class="w">                </span><span class="n">utazas</span><span class="p">.</span><span class="na">setUtasok</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;Vendeg_szam&quot;</span><span class="p">));</span>
<span class="w">                </span><span class="n">utazas</span><span class="p">.</span><span class="na">setEjszaka</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getInt</span><span class="p">(</span><span class="s">&quot;Ejszaka_szam&quot;</span><span class="p">));</span>

<span class="w">                </span><span class="n">result</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">utazas</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">){</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<h2 id="view-reteg">View réteg<a class="headerlink" href="#view-reteg" title="Permanent link">&para;</a></h2>
<p>A megjelenítési réteg tartalmazza azokat az osztályokat, amikkel a felhasználó közvetlenül kapcsolatot teremt, vagyis a grafikus felület elemeit.
A réteg elemei a controllerek segítségével módosítják az adatbázis tartalmát, de fontos, hogy azt közvetlenül nem érhetik el.</p>
<h2 id="videok">Videók<a class="headerlink" href="#videok" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.youtube.com/playlist?list=PLXU1x2KQNiR3-SURMdqOtDILmfrCKKp5V">Aktuális lejátszási lista</a></li>
</ul>
<h2 id="referenciak">Referenciák<a class="headerlink" href="#referenciak" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://docs.oracle.com/javase/tutorial/jdbc/basics/index.html">Oracle JDBC Tutorial</a></li>
</ul>

  <hr>
<div class="md-source-file">
  <small>
    
      Utolsó frissítés:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime">2024-03-19 06:37:54</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2004-2024 Szegedi Tudományegyetem, Informatikai Intézet, Szoftverfejlesztés Tanszék
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/index.html" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["tabs"], "search": "../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "V\u00e1g\u00f3lapra m\u00e1solva", "clipboard.copy": "M\u00e1sol\u00e1s v\u00e1g\u00f3lapra", "search.result.more.one": "1 tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.more.other": "# tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.none": "Nincs tal\u00e1lat", "search.result.one": "1 egyez\u0151 dokumentum", "search.result.other": "# egyez\u0151 dokumentum", "search.result.placeholder": "Keres\u00e9shez \u00edrj ide valamit", "search.result.term.missing": "\u00dcres", "select.version": "Verzi\u00f3v\u00e1lt\u00e1s"}}</script>
    
    
      <script src="../assets/javascripts/bundle.a00a7c5e.min.js"></script>
      
        <script src="../js/main.js"></script>
      
    
  </body>
</html>